A. Дерево отрезков на сумму
ограничение по времени на тест 1 секунда
ограничение по памяти на тест 1024 мегабайта
вводстандартный ввод
выводстандартный вывод
В этой задаче вам нужно написать обычное дерево отрезков на сумму.

Входные данные
Первая строка содержит два числа n и m (1≤n,m≤100000) — размер массива и число операций. Следующая строка содержит n чисел ai — начальное состояние массива (0≤ai≤109). Далее следует описание операций. Описание каждой операции имеет следущий вид:

1 i v — присвоить элементу с индексом i значение v (0≤i<n, 0≤v≤10^9).
2 l r — вычислить сумму элементов с индексами от l до r−1 (0≤l<r≤n).
Выходные данные
Для каждой операции второго типа выведите соответствующую сумму.

Пример
входные данные
5 5
5 4 2 3 5
2 0 3
1 1 1
2 0 3
1 3 1
2 0 5
выходные данные
11
8
14


B. Число минимумов на отрезке
ограничение по времени на тест 1 секунда
ограничение по памяти на тест 1024 мегабайта
вводстандартный ввод
выводстандартный вывод
Теперь измените код дерева отрезков, чтобы кроме минимума на отрезке считалось также и число элементов, равных минимуму.

Входные данные
Первая строка содержит два числа n и m (1≤n,m≤100000) — размер массива и число операций. Следующая строка содержит n чисел ai — начальное состояние массива (0≤ai≤109). Далее следует описание операций. Описание каждой операции имеет следущий вид:

1 i v — присвоить элементу с индексом i значение v (0≤i<n, 0≤v≤10^9).
2 l r — найти минимум и число элементов, равных минимуму, среди элементов с индексами от l до r−1 (0≤l<r≤n).
Выходные данные
Для каждой операции второго типа выведите два числа — минимум на заданном отрезке и число элементов, равных этому минимуму.

Пример
входные данные
5 5
3 4 3 5 2
2 0 3
1 1 2
2 0 3
1 0 2
2 0 5
выходные данные
3 2
2 1
2 3


C. Отрезок с максимальной суммой
ограничение по времени на тест 1 секунда
ограничение по памяти на тест 1024 мегабайта
вводстандартный ввод
выводстандартный вывод
В этой задаче вам нужно написать дерево отрезков для нахождения подотрезка с максимальной суммой.

Входные данные
Первая строка содержит два числа n и m (1≤n,m≤100000) — размер массива и число операций. Следующая строка содержит n чисел ai — начальное состояние массива (−109≤ai≤109). Далее следует описание операций. Описание каждой операции имеет следующий вид: i v — присвоить элементу с индексом i значения v (0≤i<n, −109≤v≤109).

Выходные данные
Выведите m+1 строку: максимальную сумму чисел на отрезке до всех операций и после каждой операции. Обратите внимание, что этот отрезок может быть пустым (при этом сумма на нем будет равна 0)

Примеры
входные данные
5 2
5 -4 4 3 -5
4 3
3 -1
выходные данные
8
11
7
входные данные
4 2
-2 -1 -5 -4
1 3
3 2
выходные данные
0
3
3


D. K-я единица
ограничение по времени на тест 1 секунда
ограничение по памяти на тест 1024 мегабайта
вводстандартный ввод
выводстандартный вывод
В этой задаче вам нужно добавить в дерево отрезков операцию нахождения k-й единицы.

Входные данные
Первая строка содержит два числа n и m (1≤n,m≤100000) — размер массива и число операций. Следующая строка содержит n чисел ai — начальное состояние массива (ai∈{0,1} ). Далее следует описание операций. Описание каждой операции имеет следущий вид:

1 i — изменить элемент с индексом i на противоположный.
2 k — найти k-ю единицу (единицы нумеруются с 0, гарантируется, что в массиве достаточное количество единиц).
Выходные данные
Для каждой операции второго типа выведите индекс соответствующей единицы (все индексы в этой задаче от 0).

Пример
входные данные
5 7
1 1 0 1 0
2 0
2 1
2 2
1 2
2 3
1 0
2 0
выходные данные
0
1
3
3
1


F. Прибавление и минимум
ограничение по времени на тест 1 секунда
ограничение по памяти на тест 1024 мегабайта
вводстандартный ввод
выводстандартный вывод
Есть массив из n элементов, изначально заполненный нулями. Вам нужно написать структуру данных, которая обрабатывает два вида запросов:

прибавить к отрезку от l до r−1 число v,
узнать минимум на отрезке от l до r−1.
Входные данные
Первая строка содержит два числа n и m (1≤n,m≤100000) — размер массива и число операций. Далее следует описание операций. Описание каждой операции имеет следущий вид:

1 l r v — прибавить значение v к отрезку от l до r−1 (0≤l<r≤n, 0≤v≤10^9).
2 l r — узнать минимум на отрезке от l до r−1 (0≤l<r≤n).
Выходные данные
Для каждой операции второго типа выведите соответствующее значение.

Пример
входные данные
5 6
1 0 3 3
2 1 2
1 1 4 4
2 1 3
2 1 4
2 3 5
выходные данные
3
7
4
0


G. Присваивание и минимум
ограничение по времени на тест 1 секунда
ограничение по памяти на тест 1024 мегабайта
вводстандартный ввод
выводстандартный вывод
Есть массив из n элементов, изначально заполненный нулями. Вам нужно написать структуру данных, которая обрабатывает два вида запросов:

присвоить всем элементам на отрезке от l до r−1 значение v,
узнать минимум на отрезке от l до r−1.
Входные данные
Первая строка содержит два числа n и m (1≤n,m≤100000) — размер массива и число операций. Далее следует описание операций. Описание каждой операции имеет следущий вид:

1 l r v — присвоить всем элементам на отрезке от l до r−1 значение v (0≤l<r≤n, 0≤v≤10^9).
2 l r — узнать минимум на отрезке от l до r−1 (0≤l<r≤n).
Выходные данные
Для каждой операции второго типа выведите соответствующее значение.

Пример
входные данные
5 6
1 0 3 3
2 1 2
1 1 4 4
2 1 3
2 1 4
2 3 5
выходные данные
3
4
4
0


I. Криптография
ограничение по времени на тест 2 секунды
ограничение по памяти на тест 1024 мегабайта
вводстандартный ввод
выводстандартный вывод
Задано n матриц A1,A2,…,An размера 2×2. Необходимо для нескольких запросов вычислить произведение матриц Ai,Ai+1,…,Aj. Все вычисления производятся по модулю r.

Входные данные
Первая строка входного файла содержит числа r (1≤r≤10000), n (1≤n≤200000) и m (1≤m≤200000). Следующие n блоков по две строки содержащие по два числа в строке — описания матриц. Затем следуют m пар целых чисел от 1 до n, запросы на произведение на отрезке.

Выходные данные
Выведите m блоков по две строки,по два числа в каждой — произведения на отрезках. Разделяйте блоки пустой строкой. Все вычисления производятся по модулю r
Пример
входные данные
3 4 4
0 1
0 0

2 1
1 2

0 0
0 2

1 0
0 2

1 4
2 3
1 3
2 2
выходные данные
0 2
0 0

0 2
0 1

0 1
0 0

2 1
1 2
